<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!-- Generated by coWiki 0.3.0-dev (http://www.develnet.org) -->

<html>
<head>
<title>Hibernate - Using Hibernate with Tomcat and JNDI</title>

<meta name="generator" content="coWiki 0.3.0-dev, http://www.develnet.org">
<meta name="robots" content="index, follow">
<meta name="keywords" content="">
<meta name="mssmarttagspreventparsing" content="true">
<meta name="revisit-after" content="7 days">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-15">

<link rel="icon" href="favicon.ico" type="image/ico">
<link rel="shortcut icon" href="favicon.ico">

<style type="text/css" media="screen">
<!--

  a {
    color: #256b87;
    text-decoration: none;
  }

  a:visited {
    color: #888888;
  }

a:hover {
    color: black;
}

  p, ol, ul, li, dl, dt, dd, blockquote {
    font-family: Verdana, Sans-serif;
    font-size: 12px;
    text-align: ;
    line-height: 130%;
    color: #000000;
  }

    UL, OL, LI {
        list-style: square;
        font-size: 100%;
        line-height: 120%;
    }

  td, th {
    font-family: Verdana, Sans-serif;
    font-size: 12px;
    color: #000000;
    font-weight: 500;
  }

  span {
    font-size: 12px;
    color: #000000;
    font-weight: 500;
  }

  blockquote {
    font-size: 100%;
    margin-right: 0px;
  }

  h1, h2, h3, h4, h5, h6  {
    color: #000000;
  }

  h1 { font-size: 150%; margin-top: 10px;}
  h2 { font-size: 130%; font-weight: bold; margin-top: 25px;}
  h3 { font-size: 110%; font-weight: bold; margin-top: 20px;}
  h4 { font-size: 105%; font-weight: bold;}
  h5 { font-size: 100%; font-style: italic; }
  h6 { font-size: 100%; font-style: italic; }

  pre, tt {
    font-size: 90%;
    font-family: monospace;
    color: #000000;
  }

  pre.code {
    font-size: 90%;
    font-family: monospace;
    padding: 5px;
    border-style: solid;
    border-width: 1px;
    border-color: #CCCCCC;
    background-color: #eeeeee;
  }

  hr  {
    width: 100%;
    height: 2px;
    background-color: #CCCCCC;
    border-width: 0px;
    padding: 0px;
    color: #CCCCCC;
  }

  input, textarea  {
    font-size: 90%;
    font-family: monospace;
    color: #000000;
    border-width: 1px;
  }

  input.submit {
    font-family: Verdana, Sans-serif;
    font-size: 12px;
    font-weight: bold;
    background-color: #a0a0a0;
    border-width: 1px;
    color: white;
  }

  textarea {
    padding-left: 2px;
  }

  select {
    font-family: monospace;
    font-size: 13.9px;
    color: #000000;
  }

  fieldset {
    margin: 0px;
    padding: 5px;
  }

  legend {
    font-size: 92%;
  }

  /* ------------------------------------------------------------------*/

  .area {
    border-style: solid;
    border-width: 1px;
    border-left-color: #ffffff;
    border-top-color: #ffffff;
    border-right-color: #ffffff;
    border-bottom-color: #ffffff;
    background-color: #FFFFFF;
  }

  .areaoverflow {
    overflow: auto;
    border-style: solid;
    border-width: 1px;
    border-left-color: #ffffff;
    border-top-color: #ffffff;
    border-right-color: #ffffff;
    border-bottom-color: #ffffff;
    padding: 3px;
    background-color: #FFFFFF;
  }

  .areainset {
    border-style: solid;
    border-width: 1px;
    border-left-color: #ffffff;
    border-top-color: #ffffff;
    border-right-color: #ffffff;
    border-bottom-color: #ffffff;
    padding: 3px;
  }

  .window {
    border-style: outset;
    border-width: 2px;
    border-right-width: 1px;
    border-bottom-width: 1px;
    border-left-color: #ffffff;
    border-top-color: #ffffff;
    border-right-color: #ffffff;
    border-bottom-color: #ffffff;
  }

  .wintitle {
    font-family: Verdana, Sans-serif;
    background-color: #59666C;
    color: #FFFFFF;
    font-weight: bold;
    font-size: 13.4px;
  }

  .tuborgbox {
    border-style: solid;
    border-width: 0px;
    border-top-color: #ffffff;
    border-left-color: #ffffff;
    border-right-color: #ffffff;
    border-bottom-color: #ffffff;
  }

  .tuborgboxsimple {
    border-style: solid;
    border-width: 1px;
    border-color: black;
  }

  .rappsbox {
  }

  .rappsboxsimple {
    border-style: solid;
    border-width: 0px;
    border-color: black;
  }

  .spacer {
    font-size: 2px;
  }

  .error {
    color: #880000;
  }

  .missing {
    font-size: 90%;
    color: #880000;
    text-decoration: none;
    background-color: #BCAE79;
    border-style: solid;
    border-width: 1px;
    border-left-color: #ffffff;
    border-top-color: #ffffff;
    border-right-color: #ffffff;
    border-bottom-color: #ffffff;
  }

  .monospace {
    font-family: monospace;
    font-size: 92%;
  }

  .diff {
    font-family: monospace;
    font-size: 92%;
  }

  .label { font-size: 10px; font-family: Verdana, Sans-Serif; font-weight: bold; color: #ffffff; }


  .label:visited {
    color: white;
  }

  .labeldisabled { text-decoration: none; font-size: 90%; font-weight: bold; color: #CCCCCC; }

  .textbut {
    background-color: #BCAE79;
    border-style: solid;
    border-width: 1px;
    border-top-color: #ffffff;
    border-left-color: #ffffff;
    border-right-color: #ffffff;
    border-bottom-color: #ffffff;
    padding-top: 1px;
    padding-bottom: 2px;
  }

  .imgbut {
    border-style: solid;
    border-width: 1px;
    border-top-color: #ffffff;
    border-left-color: #ffffff;
    border-right-color: #ffffff;
    border-bottom-color: #ffffff;
  }

  .breadcrumb {
    font-size:90%;
  }

  .breadcrumb:visited {
  }

  .menubottom {
  }

  .menubottom:visited {
    color: #256b87;
  }

  .tiny {
    font-family: Verdana, Sans-serif;
    font-size: 11px;
  }

  .small {
    font-family: Verdana, Sans-serif;
    font-size: 12px;
  }

  .medium {
    font-family: Verdana, Sans-serif;
    font-size: 13px;
  }

  .big {
    font-family: Verdana, Sans-serif;
    font-size: 20px;
  }

-->
</style>

<script language="JavaScript" type="text/javascript">
<!--

  // Do not remove (or change) the JavaScript part, and wonder about errors.
  // First change your plugins and templates not to use these functions.
  // Never use JavaScript for essential functionalities! You may use it
  // for uncritical and superfluous gimmicks.

  window.onerror = null;
  var undefined;

  // ----------------------------------------------------------------------

  function getParentNodeByName(obj, tag) {
    if (!obj.parentNode) { return false; }

    if (obj.parentNode.nodeName.toLowerCase() == tag.toLowerCase()) {
      return obj.parentNode;
    }

    return getParentNodeByName(obj.parentNode, tag);
  }

  // ----------------------------------------------------------------------

  function getPrevSiblingNodeByName(obj, tag) {
    if (!obj.previousSibling) { return false; }

    if (obj.previousSibling.nodeName.toLowerCase() == tag.toLowerCase()) {
      return obj.previousSibling;
    }

    return getPrevSiblingNodeByName(obj.previousSibling, tag);
  }

  // ----------------------------------------------------------------------

  function getNextSiblingNodeByName(obj, tag) {
    if (!obj.nextSibling) { return false; }

    if (obj.nextSibling.nodeName.toLowerCase() == tag.toLowerCase()) {
      return obj.nextSibling;
    }

    return getNextSiblingNodeByName(obj.nextSibling, tag);
  }

  // ----------------------------------------------------------------------

  function fireClickEvent(nodeId) {
    if (document.getElementById) {
      if (obj = document.getElementById(nodeId)) {
        obj.click();
      }
    }
  }

  // ----------------------------------------------------------------------

  function fireClickEventOnChild(obj, tag) {
    if (obj.hasChildNodes) {
      for (i=0; i<obj.childNodes.length; i++) {
        if (obj.childNodes[i].nodeName.toLowerCase() == tag.toLowerCase()) {

          if (obj.childNodes[i].click) {
            obj.childNodes[i].click();
            break;
          }

        }
      }
    }
  }

  // ----------------------------------------------------------------------

  function mover(obj, color) {
    if (color == undefined) {
      obj.style.backgroundColor = '#59666C';
    } else {
      obj.style.backgroundColor = color;
    }
  }

  // ----------------------------------------------------------------------

  function mout(obj, color) {
    if (color == undefined) {
      obj.style.backgroundColor = '#BCAE79';
    } else {
      obj.style.backgroundColor = color;
    }
  }

  // ----------------------------------------------------------------------

  function moverOnParentName(obj, tag, color) {
    newObj = getParentNodeByName(obj, tag);
    if (!newObj) { return; }

    if (color == undefined) {
      mover(newObj);
    } else {
      mover(newObj, color);
    }
  }

  // ----------------------------------------------------------------------

  function moutOnParentName(obj, tag, color) {
    newObj = getParentNodeByName(obj, tag);
    if (!newObj) { return; }

    if (color == undefined) {
      mout(newObj);
    } else {
      mout(newObj, color);
    }
  }

  // ----------------------------------------------------------------------

  function moverOnPrevSiblingName(obj, tag, color) {
    newObj = getPrevSiblingNodeByName(obj, tag);
    if (!newObj) { return; }

    if (color == undefined) {
      mover(newObj);
    } else {
      mover(newObj, color);
    }
  }

  // ----------------------------------------------------------------------

  function moutOnPrevSiblingName(obj, tag, color) {
    newObj = getPrevSiblingNodeByName(obj, tag);
    if (!newObj) { return; }

    if (color == undefined) {
      mout(newObj);
    } else {
      mout(newObj, color);
    }
  }

  // ----------------------------------------------------------------------

  function moverOnNextSiblingName(obj, tag, color) {
    newObj = getNextSiblingNodeByName(obj, tag);
    if (!newObj) { return; }

    if (color == undefined) {
      mover(newObj);
    } else {
      mover(newObj, color);
    }
  }

  // ----------------------------------------------------------------------

  function moutOnNextSiblingName(obj, tag, color) {
    newObj = getNextSiblingNodeByName(obj, tag);
    if (!newObj) { return; }

    if (color == undefined) {
      mout(newObj);
    } else {
      mout(newObj, color);
    }
  }

//-->
</script>


</head>




<body text="#000000"
      link="#256b87" alink="#256b87"
      vlink="#888888" bgcolor="#FFFFFF"
      leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" style="margin-right:3px"
>
<noindex>

<table width="100%" cellpadding="0" cellspacing="0" border="0">
    <tr>
        <td rowspan="2"width="100%"><a href="index.html"><img
                src="tpl/hibernate2/img/hibernate_logo.gif" width="220" height="63"
                alt="HIBERNATE" border="0"></a></td>
        <td align="right">        
            <a href="http://www.jboss.org/"><IMG
            border="0" src="hib_images/jboss_logo_small_nb.gif" alt="JBoss.org"></a>
        </td>
    </tr>
    <tr>
        <td>
            <table cellpadding="1" cellspacing="0" border="0">
                <tr>
                <td align="right" valign="bottom">
                    
                </td>
                <td valign="bottom" style="font-size:70%; color:#aaaaaa;">&nbsp;|&nbsp;</td>
                <td valign="bottom"  style="font-size: 70%;">
                    <a href="http://forum.hibernate.org/profile.php?mode=register">Register</a>
                </td>
                <td valign="bottom" style="font-size:70%; color:#aaaaaa;">&nbsp;|&nbsp;</td>        
                <td align="right" valign="bottom" width="70">
                    
                </td>
                </tr>
            </table>
        
        </td>
    </tr>
</table>


<table width="100%" bgcolor="#BCAE79" cellspacing="0"
  cellpadding="0" border="0" class="tuborgbox">
  <tr>
    <td width="100%" class="label" height="20">&nbsp;</td>

      
      

      <td>&nbsp;&nbsp;&nbsp;</td>

      

  </tr>
</table>

<table cellpadding="0" cellspacing="0" border="0"><tr><td><img src="tpl/hibernate2/img/0.gif" width="1" height="4" alt="" border="0"></td></tr></table>

</noindex>
<table cellpadding="0" cellspacing="0" border="0">
<tr>
<td>
    <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
        <td bgcolor="white"
            ><img src="tpl/hibernate2/img/0.gif"
            width="1" height="2" alt="" border="0"></td>
        </tr>
    </table>
</td>
</tr>
<tr>
    <td bgcolor="#cccccc" valign="top" align="left" class="rappsbox">
    
      <table width="165"  bgcolor="#a0a0a0" cellpadding="0"
cellspacing="0" border="0">
<tr>
    <td>

    

      

      <table cellpadding="0" cellspacing="0" border="0" bgcolor="#a0a0a0">
        <tr>
          <td></td>
          <td><img src="tpl/hibernate2/img/0.gif" hspace="7" vspace="0" width="1" height="1" alt="" border="0"></td>
          <td height="20"
            onmouseover="moverOnParentName(this, 'TR', '#59666C')"
            onmouseout="moutOnParentName(this, 'TR', '#a0a0a0')"
            onmouseup="fireClickEventOnChild(this, 'A')"
            nowrap width="100%"><a onfocus="if (this.blur) this.blur()"
            href="1.html"
            class="label"><span class="label">News</span></a>&nbsp;</td>
        </tr>
      </table>

    

      
          <table width="100%" cellpadding="0" cellspacing="0" border="0">
            <tr>
              <td bgcolor="#ffffff"
                ><img src="tpl/hibernate2/img/0.gif"
                width="1" height="1" alt="" border="0"></td>
            </tr>
            <tr>
              <td bgcolor="#ffffff"
                ><img src="tpl/hibernate2/img/0.gif"
                width="1" height="1" alt="" border="0"></td>
             </tr>
          </table>

      <table cellpadding="0" cellspacing="0" border="0" bgcolor="#a0a0a0">
        <tr>
          <td></td>
          <td><img src="tpl/hibernate2/img/0.gif" hspace="7" vspace="0" width="1" height="1" alt="" border="0"></td>
          <td height="20"
            onmouseover="moverOnParentName(this, 'TR', '#59666C')"
            onmouseout="moutOnParentName(this, 'TR', '#a0a0a0')"
            onmouseup="fireClickEventOnChild(this, 'A')"
            nowrap width="100%"><a onfocus="if (this.blur) this.blur()"
            href="4.html"
            class="label"><span class="label">About</span></a>&nbsp;</td>
        </tr>
      </table>

    

      

      <table cellpadding="0" cellspacing="0" border="0" bgcolor="#a0a0a0">
        <tr>
          <td>&nbsp;&nbsp;</td>
          <td><img src="tpl/hibernate2/img/0.gif" hspace="7" vspace="0" width="1" height="1" alt="" border="0"></td>
          <td height="20"
            onmouseover="moverOnParentName(this, 'TR', '#59666C')"
            onmouseout="moutOnParentName(this, 'TR', '#a0a0a0')"
            onmouseup="fireClickEventOnChild(this, 'A')"
            nowrap width="100%"><a onfocus="if (this.blur) this.blur()"
            href="21.html"
            class="label"><span class="label">Feature List</span></a>&nbsp;</td>
        </tr>
      </table>

    

      

      <table cellpadding="0" cellspacing="0" border="0" bgcolor="#a0a0a0">
        <tr>
          <td>&nbsp;&nbsp;</td>
          <td><img src="tpl/hibernate2/img/0.gif" hspace="7" vspace="0" width="1" height="1" alt="" border="0"></td>
          <td height="20"
            onmouseover="moverOnParentName(this, 'TR', '#59666C')"
            onmouseout="moutOnParentName(this, 'TR', '#a0a0a0')"
            onmouseup="fireClickEventOnChild(this, 'A')"
            nowrap width="100%"><a onfocus="if (this.blur) this.blur()"
            href="200.html"
            class="label"><span class="label">Road Map</span></a>&nbsp;</td>
        </tr>
      </table>

    

      
          <table width="100%" cellpadding="0" cellspacing="0" border="0">
            <tr>
              <td bgcolor="#ffffff"
                ><img src="tpl/hibernate2/img/0.gif"
                width="1" height="1" alt="" border="0"></td>
            </tr>
            <tr>
              <td bgcolor="#ffffff"
                ><img src="tpl/hibernate2/img/0.gif"
                width="1" height="1" alt="" border="0"></td>
             </tr>
          </table>

      <table cellpadding="0" cellspacing="0" border="0" bgcolor="#a0a0a0">
        <tr>
          <td></td>
          <td><img src="tpl/hibernate2/img/0.gif" hspace="7" vspace="0" width="1" height="1" alt="" border="0"></td>
          <td height="20"
            onmouseover="moverOnParentName(this, 'TR', '#59666C')"
            onmouseout="moutOnParentName(this, 'TR', '#a0a0a0')"
            onmouseup="fireClickEventOnChild(this, 'A')"
            nowrap width="100%"><a onfocus="if (this.blur) this.blur()"
            href="5.html"
            class="label"><span class="label">Documentation</span></a>&nbsp;</td>
        </tr>
      </table>

    

      

      <table cellpadding="0" cellspacing="0" border="0" bgcolor="#a0a0a0">
        <tr>
          <td>&nbsp;&nbsp;</td>
          <td><img src="tpl/hibernate2/img/0.gif" hspace="7" vspace="0" width="1" height="1" alt="" border="0"></td>
          <td height="20"
            onmouseover="moverOnParentName(this, 'TR', '#59666C')"
            onmouseout="moutOnParentName(this, 'TR', '#a0a0a0')"
            onmouseup="fireClickEventOnChild(this, 'A')"
            nowrap width="100%"><a onfocus="if (this.blur) this.blur()"
            href="27.html"
            class="label"><span class="label">Related Projects</span></a>&nbsp;</td>
        </tr>
      </table>

    

      

      <table cellpadding="0" cellspacing="0" border="0" bgcolor="#a0a0a0">
        <tr>
          <td>&nbsp;&nbsp;</td>
          <td><img src="tpl/hibernate2/img/0.gif" hspace="7" vspace="0" width="1" height="1" alt="" border="0"></td>
          <td height="20"
            onmouseover="moverOnParentName(this, 'TR', '#59666C')"
            onmouseout="moutOnParentName(this, 'TR', '#a0a0a0')"
            onmouseup="fireClickEventOnChild(this, 'A')"
            nowrap width="100%"><a onfocus="if (this.blur) this.blur()"
            href="78.html"
            class="label"><span class="label">External Documentation</span></a>&nbsp;</td>
        </tr>
      </table>

    

      
          <table width="100%" cellpadding="0" cellspacing="0" border="0">
            <tr>
              <td bgcolor="#ffffff"
                ><img src="tpl/hibernate2/img/0.gif"
                width="1" height="1" alt="" border="0"></td>
            </tr>
            <tr>
              <td bgcolor="#ffffff"
                ><img src="tpl/hibernate2/img/0.gif"
                width="1" height="1" alt="" border="0"></td>
             </tr>
          </table>

      <table cellpadding="0" cellspacing="0" border="0" bgcolor="#a0a0a0">
        <tr>
          <td></td>
          <td><img src="tpl/hibernate2/img/0.gif" hspace="7" vspace="0" width="1" height="1" alt="" border="0"></td>
          <td height="20"
            onmouseover="moverOnParentName(this, 'TR', '#59666C')"
            onmouseout="moutOnParentName(this, 'TR', '#a0a0a0')"
            onmouseup="fireClickEventOnChild(this, 'A')"
            nowrap width="100%"><a onfocus="if (this.blur) this.blur()"
            href="6.html"
            class="label"><span class="label">Download</span></a>&nbsp;</td>
        </tr>
      </table>

    

      
          <table width="100%" cellpadding="0" cellspacing="0" border="0">
            <tr>
              <td bgcolor="#ffffff"
                ><img src="tpl/hibernate2/img/0.gif"
                width="1" height="1" alt="" border="0"></td>
            </tr>
            <tr>
              <td bgcolor="#ffffff"
                ><img src="tpl/hibernate2/img/0.gif"
                width="1" height="1" alt="" border="0"></td>
             </tr>
          </table>

      <table cellpadding="0" cellspacing="0" border="0" bgcolor="#a0a0a0">
        <tr>
          <td></td>
          <td><img src="tpl/hibernate2/img/0.gif" hspace="7" vspace="0" width="1" height="1" alt="" border="0"></td>
          <td height="20"
            onmouseover="moverOnParentName(this, 'TR', '#59666C')"
            onmouseout="moutOnParentName(this, 'TR', '#a0a0a0')"
            onmouseup="fireClickEventOnChild(this, 'A')"
            nowrap width="100%"><a onfocus="if (this.blur) this.blur()"
            href="20.html"
            class="label"><span class="label">Forum &amp; Mailinglists</span></a>&nbsp;</td>
        </tr>
      </table>

    

      
          <table width="100%" cellpadding="0" cellspacing="0" border="0">
            <tr>
              <td bgcolor="#ffffff"
                ><img src="tpl/hibernate2/img/0.gif"
                width="1" height="1" alt="" border="0"></td>
            </tr>
            <tr>
              <td bgcolor="#ffffff"
                ><img src="tpl/hibernate2/img/0.gif"
                width="1" height="1" alt="" border="0"></td>
             </tr>
          </table>

      <table cellpadding="0" cellspacing="0" border="0" bgcolor="#a0a0a0">
        <tr>
          <td></td>
          <td><img src="tpl/hibernate2/img/0.gif" hspace="7" vspace="0" width="1" height="1" alt="" border="0"></td>
          <td height="20"
            onmouseover="moverOnParentName(this, 'TR', '#59666C')"
            onmouseout="moutOnParentName(this, 'TR', '#a0a0a0')"
            onmouseup="fireClickEventOnChild(this, 'A')"
            nowrap width="100%"><a onfocus="if (this.blur) this.blur()"
            href="148.html"
            class="label"><span class="label">Support &amp; Training</span></a>&nbsp;</td>
        </tr>
      </table>

    

    <!-- Separator -->
    <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
        <td bgcolor="white"
            ><img src="tpl/hibernate2/img/0.gif"
            width="1" height="2" alt="" border="0"></td>
        </tr>
    </table>

    <!-- JIRA fixed position -->
    <table cellpadding="0" cellspacing="0" border="0" bgcolor="#a0a0a0">
        <tr>
        <td></td>
          <td><img src="tpl/hibernate2/img/0.gif" hspace="7" vspace="0" width="1" height="1" alt="" border="0"></td>
        <td height="20"
            onmouseover="moverOnParentName(this, 'TR', '#59666C')"
            onmouseout="moutOnParentName(this, 'TR', '#a0a0a0')"
            onmouseup="fireClickEventOnChild(this, 'A')"
            nowrap width="100%"><a onfocus="if (this.blur) this.blur()"
            href="217.html"
            class="label"><span class="label">JIRA Issue Tracking</span></a></td>
        </tr>
    </table>

    <!-- Separator -->
    <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
        <td bgcolor="#FFFFFF"><img src="tpl/hibernate2/img/0.gif"
            width="1" height="2" alt="" border="0"></td>
        </tr>
    </table>

    <!-- WIKI  -->
    <table cellpadding="0" cellspacing="0" border="0" bgcolor="#BCAE79">
        <tr>
        <td></td>
          <td><img src="tpl/hibernate2/img/0.gif" hspace="7" vspace="0" width="1" height="1" alt="" border="0"></td>
        <td height="20"
            onmouseover="moverOnParentName(this, 'TR', '#59666C')"
            onmouseout="moutOnParentName(this, 'TR', '#BCAE79')"
            onmouseup="fireClickEventOnChild(this, 'A')"
            nowrap width="100%"><a onfocus="if (this.blur) this.blur()"
            href="37.html"
            class="label" bgcolor="#BCAE79"><span class="label">Wiki Community Area</label></a></td>
        </tr>
    </table>

    <!-- Separator -->
    <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
        <td bgcolor="#FFFFFF"><img src="tpl/hibernate2/img/0.gif"
            width="1" height="2" alt="" border="0"></td>
        </tr>
    </table>

    </td>
</tr></table>

<br/>

<br/>
<div align="center">
<a href="175.html"><img
src="hib_images/hibernate_banner02g_125.gif" width="117" height="125"
alt="Hibernate Public Training Courses" border="0"/></a>
</div>

<br/>

<br/>
<div align="center">
<a href="http://www.manning.com/bauer"><img
src="hib_images/hia_banner01.gif" width="124" height="135"
alt="Get Hibernate in Action eBook!" border="0" /></a>
</div>

<br/>
<br/>
<div align="center">
<img src="hib_images/jw_finalist2003.png" border=0" alt="JavaWorld 2003 Finalist">
</div>

<br/>
<br/>
<div align="center">
<img src="hib_images/jolt_winner.png" border=0" alt="Jolt Award 2004 Winner">
</div>

          
    </td>
    <td valign="top" width="100%">
    
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
      <tr>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
        <td rowspan="2" width="100%" valign="top">

        <table width="100%" cellpadding="0" cellspacing="0" border="0">
            <tr height="10">
            <td width="100%">
                <table cellpadding="0" cellspacing="0" border="0">
  <tr>
    <td>
      

        
        <a href="5.html" class="breadcrumb"><b>Documentation</b></a>&nbsp;<tt>&gt;</tt>

      

        
        <a href="36.html" class="breadcrumb"><b>Community Area</b></a>&nbsp;<tt>&gt;</tt>

      

      <span class="breadcrumb">Using Hibernate with Tomcat and JNDI</span>
    </td>
  </tr>
</table>

            </td>
            </tr>
            <tr>
            <td>
                <hr width="100%">
    
                
    
                
<a name="A1"></a><h1>Using Hibernate with Tomcat and JNDI</h1>
<a name="A2"></a><h2>Preface</h2><p>Tomcat comes bundled with a read-only JNDI context. This means Hibernate can not bind its <tt>SessionFactory</tt> to JNDI, even if you specify a name for it in the properties or <tt>hibernate.cfg.xml</tt>. In this case, you have to create the <tt>SessionFactory</tt> from a <tt>Configuration</tt> and store it in your own implementation of a singleton registry. Every execution thread calls this singleton and retrieves the <tt>SessionFactory</tt> to create a <tt>Session</tt>. Here's a <tt>hibernate.cfg.xml</tt> example that prevents <tt>SessionFactory</tt> JNDI binding:</p>
<pre class="code">
&lt;hibernate-configuration&gt;

&lt;session-factory&gt;
&lt;!-- Use a Tomcat JNDI datasource --&gt;
&lt;property name=&quot;connection.datasource&quot;&gt;java:comp/env/jdbc/mydb&lt;/property&gt;
&lt;property name=&quot;show_sql&quot;&gt;false&lt;/property&gt;
&lt;property name=&quot;use_outer_join&quot;&gt;true&lt;/property&gt;
&lt;property name=&quot;dialect&quot;&gt;net.sf.hibernate.dialect.PostgreSQLDialect&lt;/property&gt;

&lt;mapping resource=&quot;myclasses.hbm.xml&quot;/&gt;

&lt;/session-factory&gt;

&lt;/hibernate-configuration&gt;
</pre><p>This configuration uses a datasource bound to JNDI (see the Tomcat JNDI howto), but doesn't bind the <tt>SessionFactory</tt> to JNDI. You have to create and hold it in your own application code.</p>
<a name="A3"></a><h2>Usual solution</h2><p>A good solution for this problem is the <a href="42.html">Thread Local Session</a> design pattern with a minor modification to replace the JNDI lookup for the <tt>SessionFactory</tt>:</p>
<pre class="code">
public class HibernateSession {

private static SessionFactory sessionFactory;
public static final ThreadLocal session = new ThreadLocal();

public static Session currentSession()
throws HibernateException {

Session s = (Session) session.get();
if (s == null) {

// Don't get from JNDI, use a static SessionFactory
if (sessionFactory == null) {

// Use default hibernate.cfg.xml
sessionFactory = new Configuration().configure().buildSessionFactory();

}

s = sessionFactory.openSession();
session.set(s);
}
return s;
}

public static void closeSession()
throws HibernateException {

Session s = (Session) session.get();
session.set(null);
if (s != null) s.close();
}

}
</pre>
<a name="A4"></a><h2>Let Tomcat do the binding</h2><p>Bertrand Lancelot (blancelot@partner.auchan.com) posted another method to the Hibernate developer list: It is possible to bind the <tt>SessionFactory</tt> to Tomcats JNDI. Instead of specifying a name in the Hibernate configuration, you have to implement an <tt>ObjectFactory</tt> and let Tomcat do the binding. Here's a quote from his e-mail:</p><p><em>Tomcat can initialize JNDI names thanks <tt>to server.xml</tt> with <tt>&lt;GlobalNamingResources&gt;</tt>, <tt>&lt;Resource&gt;</tt> and <tt>&lt;ResourceParams&gt;</tt>, but to configure that, we have to use a class which implements <tt>javax.naming.ObjectFactory</tt>. There is no class in Hibernate that implements it. That's why we can't configure Tomcat to get a SessionFactory with JNDI. I create this class and after many tests, I had good results to get a <tt>SessionFactory</tt> and to create <tt>Sessions</tt>.</em></p>
<pre class="code">
import java.io.File;
import java.io.InputStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Hashtable;
import java.util.Iterator;
import javax.naming.Context;
import javax.naming.Name;
import javax.naming.NamingException;
import javax.naming.RefAddr;
import javax.naming.Reference;
import javax.naming.spi.ObjectFactory;

import net.sf.hibernate.HibernateException;
import net.sf.hibernate.SessionFactory;
import net.sf.hibernate.cfg.Configuration;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.apache.commons.logging.impl.SimpleLog;
import org.apache.commons.logging.LogConfigurationException;

/**
* JndiSessionFactoryImpl to configure in an API Server to initialize
* a SessionFactory in a JNDI context.
*
* Tomcat Configuration in server.xml :
*
* &lt;!-- Global JNDI resources --&gt;
* &lt;GlobalNamingResources&gt;
* ...
* &lt;Resource description=&quot;SessionFactory Resource&quot;
* name=&quot;HibernateSessionFactory&quot; auth=&quot;Container&quot;
* type=&quot;net.sf.hibernate.SessionFactory&quot;/&gt;
* &lt;ResourceParams name=&quot;HibernateSessionFactory&quot;&gt;
* &lt;parameter&gt;
* &lt;name&gt;factory&lt;/name&gt;
* &lt;value&gt;JndiSessionFactoryImpl&lt;/value&gt;
* &lt;/parameter&gt;
* &lt;parameter&gt;
* &lt;name&gt;pathname&lt;/name&gt;
* &lt;value&gt;conf/hibernate.cfg.xml&lt;/value&gt;
* &lt;/parameter&gt;
* &lt;/ResourceParams&gt;
* &lt;/GlobalNamingResources&gt;
*
* ...
* &lt;!-- Define the Tomcat Stand-Alone Service --&gt;
* &lt;Service name=&quot;Tomcat-Standalone&quot;&gt;
* &lt;!-- Define the top level container in our container hierarchy --&gt;
* &lt;Engine name=&quot;Standalone&quot; defaultHost=&quot;localhost&quot; debug=&quot;0&quot;&gt;
* &lt;Host name=&quot;localhost&quot; debug=&quot;0&quot; appBase=&quot;webapps&quot;
* unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;
* ...
* &lt;Context path=&quot;/testjndi&quot; docBase=&quot;/testjndi.war&quot; debug=&quot;0&quot;
* reloadable=&quot;true&quot; crossContext=&quot;true&quot; privileged=&quot;true&quot; useNaming=&quot;true&quot;&gt;
* &lt;Logger className=&quot;org.apache.catalina.logger.FileLogger&quot;
* prefix=&quot;localhost_jndi_log.&quot; suffix=&quot;.txt&quot;
* timestamp=&quot;true&quot;/&gt;
* &lt;ResourceLink name=&quot;hibernate/SessionFactory&quot;
* global=&quot;HibernateSessionFactory&quot;
* type=&quot;net.sf.hibernate.SessionFactory&quot;/&gt;
* &lt;/Context&gt;
* &lt;/Host&gt;
* &lt;/Engine&gt;
* &lt;/Service&gt;
*
*/
public class JndiSessionFactoryImpl implements ObjectFactory {

public static final String PATH_NAME = &quot;pathname&quot;;
private static SessionFactory sf = null;
private static Log log = null;

static {
try {
log = LogFactory.getLog (JndiSessionFactoryImpl.class);
} catch (LogConfigurationException e) {
System.err.println (&quot;Cannot get a LogFactory instance!&quot;);
log = new SimpleLog(&quot;log&quot;);
}
}

public Object getObjectInstance(Object obj,
Name name,
Context nameCtx,
Hashtable environment)
throws NamingException {

RefAddr addr = ((Reference)obj).get (PATH_NAME);
String content = null;

log.info (&quot;Initializes a Sessionfactory instance&quot;);

if (addr != null) {
content = (String)addr.getContent ();
} else {
log.error(&quot;parameter &quot; + PATH_NAME + &quot; not found&quot;);
}

log.debug (&quot;pathname : &quot; + content);

if (System.getProperty (&quot;api.server.home&quot;) == null) {
log.error(&quot;property \&quot;api.server.home\&quot; not found!&quot;);
}

// Initialize Hibernate configuration with hibernate.cfg.xml :
log.info(&quot;Read the hibernate.cfg.xml at : &quot; +
System.getProperty(&quot;api.server.home&quot;) +
File.separator + content);

if (sf == null) {
try {
String filePath = System.getProperty(&quot;api.server.home&quot;) &quot;/&quot; + content;
File file = new File(filePath);

sf = new Configuration().configure(file).buildSessionFactory();
log.info (&quot;Sessionfactory successfully initialized!&quot;);
} catch (HibernateException e) {
log.fatal (&quot;Cannot get a SessionFactory instance&quot;, e);
}
}

return sf;
}

}
</pre><p>I've modified the original code slighty for better readability, I've not tested it. Bertrand Lancelot writes further:</p><p><strong>Tomcat Configuration:</strong></p>
<ul><li>Put all Hibernate libraries in tomcat/common/lib</li></ul>
<ul><li>This class use a new property &quot;api.server.home&quot; which must contain the API server home. Thus add =-Dapi.server.home=&quot;{%CATALINA_HOME%}&quot;=in the file catalina.bat (or cataline.sh).</li></ul>
<ul><li>Put hibernate.cfg.xml in tomcat/conf.</li></ul>
<ul><li>Put all mappings and JAVA BEANs and the factory <tt>JndiSessionFactoryImpl.class</tt> in tomcat/common/classes</li></ul>
<ul><li>If you encounter an UnsupportedOperationException, be sure to comment out the hibernate.connection.username and hibernate.connection.password entries in the hibernate.properties file (see FAQ for more details)</li></ul>
<ul><li>Finally, modify tomcat/conf/server.xml</li></ul>
<a name="A5"></a><h2>Problems</h2><p>Bertrand Lancelot further states that he had problems with his classloader with the <tt>ObjectFactory</tt> approach. His application (living in its own context) couldn't find the persistent classes he declared in his mapping. Exceptions were like:</p>
<pre class="code">
net.sf.hibernate.MappingException: No persister for: bo.Reception
at net.sf.hibernate.impl.SessionFactoryImpl.getPersister(SessionFactoryImpl.java:444)
at net.sf.hibernate.impl.SessionImpl.getPersister(SessionImpl.java:2249)
</pre><p>This was expected, because Tomcat &quot;sometimes&quot; (actually, this is the difference between the standard JDK classloader concept and the &quot;broken&quot; Servlet specification) has a different delegation strategy for its classloaders:</p><p>The classloader at the common/lib and common/classes level is not the same as the context classloader, responsible for a specific WEB-INF/lib and WEB-INF/classes. You would expect that every <tt>loadClass()</tt>, <tt>new</tt> and <tt>Class.forName()</tt> call in your application results in a search at the current level and <strong>then</strong> a delegation to the upper level classloader if no class can be found. This is not the case! The default is to <em>first</em> search with the parent classloader and if he can not find the class, with its parent classloader. This chain of responsibility continues up to the top of the classloader delegation hierarchy. Only if no classloader in the chain can find your requested class, your context classloader will get a chance to try it.</p><p>One way to modify this behaviour (and you usually want it different) is to work with the <tt>&lt;loader&gt;</tt> directive in Tomcats <tt>server.xml</tt> (in the declaration of each context):</p>
<pre class="code">
&lt;Loader checkInterval=&quot;1&quot; delegate=&quot;false&quot;/&gt;
</pre><p>This turns on auto-reloading of classes (one second check time), useful in development. It also prevents the delegation to the parent classloader: The context classloader gets the first chance to find the class for your application. The default of this attribute (true or false) seems to vary from Tomcat version to version. Much of the classloading problems in Tomcat (the broken <tt>commons-logging</tt> and <tt>log4j</tt>, for example) stems from this simple fact.</p><p>I haven't found a solution for the problem of Bertrand Lancelot (in fact, I have no time to try it) and I also don't see an advantage to the <tt>SessionFactory</tt> binding by Tomcat instead of the singleton <tt>HibernateSession</tt> class. You'll need such a class most of the time anyway, it's a good place for <tt>Configuration</tt> and <tt>SessionFactory</tt>.</p><p>If anyone has some suggestions, improvements or a solution for the classloading problem, feel free to edit this page. The obvious solution is to place persistent classes at the same level as the Hibernate libraries (ie. in common/lib or common/classes), but this is not desireable in a multi-host environment and certainly can not be recommended for various reasons.</p><p>Some links:</p>
<ul><li><a target="_blank" href="http://jakarta.apache.org/tomcat/tomcat-4.1-doc/class-loader-howto.html">Tomcat Classloader HOWTO</a></li></ul>
<ul><li><a target="_blank" href="http://jakarta.apache.org/tomcat/tomcat-4.1-doc/jndi-resources-howto.html#Adding%20Custom%20Resource%20Factories">Tomcat Custom Resource Factories with JNDI</a></li></ul>
<a name="A6"></a><h2>Related: SessionFactory Handling with the Spring Framework</h2><p>The Spring Framework offers an easy way to configure and handle SessionFactory instances, be it local or from JNDI. You can switch between various SessionFactory sources without changing a single line of Java code. Most importantly, there is no need to keep a SessionFactory in JNDI - this doesn't add any value outside of EJBs. Locally defined resources within a Spring application make deployment much easier, avoiding any container-specific configuration hassle. This applies to Tomcat in particular but also to JBoss or WebLogic. See part 6 of <a href="110.html">Data Access with the Spring Framework</a> for a discussion of this.</p><p>Furthermore, Spring provides a convenient pre-built implementation of the Thread Local Session pattern, integrated with its transaction management infrastructure via a Hibernate-specific strategy. Additionally, there's special support for Thread Local Sessions in the JTA strategy too, enabling proper cache handling without any container-specific setup. Spring also offers IoC-style templating and AOP solutions for simplified Hibernate Session handling within DAOs.</p><p>Note that Spring adopts a very lightweight approach. You can use a lot of features respectively classes in a library style, as everything is designed as a set of reusable JavaBeans. Don't be discouraged by the fact that Spring can serve as full application framework too. You're invited to review and leverage the Spring approach, no matter to what extent, before deciding to take the effort and risk of building such infrastructure in-house.</p><p><a href="110.html">Data Access with the Spring Framework</a></p><p><a href="42.html">Thread Local Session</a></p>

    
                
            </td>
            </tr>
            <tr>
            <td>
                
            </td>
            </tr>
        </table>

        </td>
        <td rowspan="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
      </tr>
      </table>
    
    </td>
</tr>
</table>


<hr>
<table width="100%" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left">
<A href="http://sourceforge.net/projects/hibernate"><IMG
border="0" src="tpl/hibernate2/img/0.gif" hspace="30" vspace="2"></A>
</td>
<td align="right" valign="middle">
<b><a href="http://www.develnet.org/">coWiki</a>&nbsp;</b>
</td>
</tr>
</table>
</body>
</html>
